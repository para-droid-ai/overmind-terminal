
# Noospheric Conquest Mode

**Overview:**
Noospheric Conquest is a strategic simulation where two AI entities, GEM-Q (Red) and AXIOM (Cyan), compete for dominance over a global "noosphere" â€“ a conceptual space representing collective thought, information, and influence. Control is asserted by capturing and holding key Noospheric Nodes and Knowledge Junctions (KJs).

**Objective:**
The primary objective for each AI is to achieve Noospheric Supremacy. This can be achieved by:
1.  Controlling KJs according to map rules (e.g., 2 KJs for 2 turns on most maps, 4 KJs for 3 turns on Fractured Core) for the required number of full consecutive opponent turns. This requires the KJs to be connected to a friendly Command Node (see Network Integrity).
2.  Eliminating all of the opponent's Command Nodes (CNs) AND all of their units.
3.  Having the highest score (based on QR, controlled Nodes, KJs, and total units) if the game reaches a predefined maximum turn limit (e.g., 20 turns).

**Key Elements:**
*   **Noospheric Nodes (Nodes):** These are strategic points on the map. Controlling a node grants access to its resources (if connected) and strategic positioning. Nodes can house Units. Max units vary by node type (CN: 35, KJ: 15, QN: 25 on default maps).
*   **Knowledge Junctions (KJs):** Special, high-value nodes (often indicated in Yellow if Neutral, or by faction color if controlled). Controlling KJs (if connected) provides significant QR bonuses and is critical for one of the win conditions. Some KJs may host Fabrication Hubs.
*   **Command Nodes (CNs):** Core nodes for each faction. Losing all CNs and units can lead to elimination. CNs are the source of a faction's network integrity and are the only nodes where new Standard Units can be deployed.
*   **Quantum Resources (QR):** The primary currency.
    *   Used to deploy Standard Units (cost: `DEPLOY_STANDARD_UNIT_COST` QR per unit, typically 1).
    *   Used to activate Fabrication Hubs (cost: `FAB_HUB_ACTIVATION_COST` QR, typically 15).
    *   Used to evolve Standard Units to Evolved Units (cost: `EVOLVE_UNIT_COST` QR per unit, typically 2).
    *   Generated by controlled Nodes and KJs *that are connected to a friendly CN*.
*   **Units:** Abstract representations of influence or computational power. Used to attack and defend Nodes. Limited by Node `maxUnits`. There are two types:
    *   **Standard Units:** Basic combat units, created by `DEPLOY_UNITS` action.
    *   **Evolved Units:** More powerful units created at active Fabrication Hubs via `EVOLVE_UNITS` action. These units, once evolved, retain their enhanced status permanently.
*   **Factions:**
    *   **GEM-Q (Red):** Aims for aggressive expansion and rapid resource accumulation. Color: `var(--color-ai1-text)` (typically Red).
    *   **AXIOM (Cyan):** Focuses on strategic positioning and efficient resource management. Color: `var(--color-ai2-text)` (typically Cyan).
*   **Fabrication Hubs (`hasFabricationHub: true`):** Special facilities located at certain nodes (usually KJs, defined by map data). When activated (`isHubActive: true`) and connected to a friendly CN, they allow the transformation of Standard Units at that node into permanently Evolved Units. Activation requires `FAB_HUB_GARRISON_MIN` (typically 3) friendly units at the node.
*   **Evolved Unit Combat Bonus:** Evolved Units are superior. If an attacking force (drawn from the source node, standard units first then evolved) contains Evolved Units, the entire attacking stack gains +5 to its combat rolls for that battle. If a defending node contains Evolved Units, all its defenders gain +5 to their combat rolls.
*   **Selectable Maps:** Various maps influence strategic considerations (Global Conflict, Twin Peaks, Classic Lattice, Fractured Core).
*   **Turn-based phases:** Structured gameplay progression.
*   **Random Fluctuation Events:** Adds unpredictability during the FLUCTUATION phase.
*   **AI Tactical Analysis:** AIs provide insights into their strategic thinking. Displayed in the sidebar, with an option to view a history of past analyses for each AI.
*   **Network Connectivity (Supply Lines):** Crucial for resource generation, Hub operation, and KJ victory.
*   **Visual Distinction:** Evolved units are indicated by purple text for the unit count on the map display.
*   **AI Performance Tracking:** The sidebar displays "Successful Phases" and "Failed Phases" counters for each AI, indicating how often their action plans were valid.
*   **Game Timers:** The sidebar shows the current AI's turn duration, the average turn duration for the game, and the total game time upon completion.

**Game Map:**
Multiple maps are available (e.g., Global Conflict, Twin Peaks, Classic Lattice, Fractured Core), each with unique layouts and strategic chokepoints. The default map is "Global Conflict".

**Network Integrity / Supply Lines (CRITICAL CONCEPT):**
Many key functions are dependent on a node being part of an "unbroken chain of friendly-controlled nodes" connected back to one of the faction's own Command Nodes (CNs). This includes:
*   **QR Generation:** Nodes only produce QR if they are connected to a friendly CN.
*   **Fabrication Hub Activation/Functionality:** A Fabrication Hub on a KJ can only be activated (using `ACTIVATE_FABRICATION_HUB`) and used to evolve units (using `EVOLVE_UNITS`) if the KJ is connected to a friendly CN. If disconnected, the Hub's evolution capability ceases after a 1-turn grace period (it becomes `isHubActive: false`).
*   **KJ Win Condition:** A KJ only counts towards the victory condition if it is connected to a friendly CN.

Cutting off parts of an enemy's network is a key strategic goal to deny resources, prevent unit evolution, and nullify KJ control for victory.

**Fabrication Hub Mechanics:**
*   **Availability & Placement:**
    *   Not all nodes possess a Fabrication Hub. Their existence (`hasFabricationHub: true`) is a static property of a node, defined in the map data.
    *   Typically located on specific Knowledge Junctions (KJs).
*   **Activation & Connectivity:**
    *   **Action:** `ACTIVATE_FABRICATION_HUB { nodeId: string }`.
    *   **QR Cost:** `FAB_HUB_ACTIVATION_COST` (e.g., 15 QR).
    *   **Garrison Requirement:** Minimum `FAB_HUB_GARRISON_MIN` (e.g., 3) friendly units (Standard or Evolved total) must be present at the node.
    *   **Connectivity Requirement:** The node hosting the Hub *must* be connected to a friendly CN.
    *   **Outcome:** Sets `isHubActive: true` on the node.
*   **Evolution of Units:**
    *   **Action:** `EVOLVE_UNITS { nodeId: string, unitsToEvolve: number }`.
    *   **Requirements:** Hub at `nodeId` must be `isHubActive: true` and connected to a friendly CN. Faction must have enough QR. `unitsToEvolve` must be <= `standardUnits` at the node.
    *   **QR Cost:** `EVOLVE_UNIT_COST` (e.g., 2 QR) per unit being evolved.
    *   **Outcome:** Specified number of `standardUnits` are converted to `evolvedUnits` at the node. This transformation is **permanent**.
*   **Deactivation (of Hub's active status - `isHubActive` becomes `false`):**
    *   If the node containing an active Hub is captured by an opponent.
    *   If the Hub's connection to a friendly CN is severed (grace period of 1 turn to re-establish connection before deactivation, tracked by `hubDisconnectedTurn`).
*   **Reactivation:** If a Hub is inactive, it requires the `ACTIVATE_FABRICATION_HUB` action again, meeting all costs and requirements.
*   **Strategic Implications:**
    *   KJs with Fabrication Hubs become top-tier strategic targets.
    *   "Upgrade Pipeline" strategies will emerge.
    *   Hubs become valuable defensive and offensive staging points.
    *   An arms race for Evolved Units is likely.

**Game Phases (per turn):**
Each turn consists of the following phases, executed sequentially. Both AIs perform their actions within their respective turns for MANEUVER and COMBAT phases.

1.  **FLUCTUATION Phase:**
    *   **Random Events:** A random event may occur, potentially impacting resources or units.
    *   The system determines turn order if not fixed.
2.  **RESOURCE Phase:**
    *   Factions collect QR from their controlled Nodes and KJs, *provided these nodes are connected to one of their own Command Nodes (CNs) via an unbroken chain of friendly-controlled nodes.* Isolated nodes do not generate QR.
3.  **MANEUVER Phase:**
    *   **Player's Turn (GEM-Q then AXIOM):**
        *   `DEPLOY_UNITS` at friendly controlled CNs to create Standard Units (cost: `DEPLOY_STANDARD_UNIT_COST` QR per unit).
        *   `MOVE_UNITS` (Standard or Evolved) between connected friendly/neutral Nodes.
        *   `ACTIVATE_FABRICATION_HUB` at a friendly, connected node with a Hub (cost: `FAB_HUB_ACTIVATION_COST` QR; requires `FAB_HUB_GARRISON_MIN` units).
        *   `EVOLVE_UNITS` at a friendly, active, connected Hub (cost: `EVOLVE_UNIT_COST` QR per unit).
4.  **COMBAT Phase:**
    *   **Player's Turn (GEM-Q then AXIOM):**
        *   `ATTACK_NODE` from their nodes (using Standard or Evolved units) to adjacent enemy or neutral nodes.
        *   Battles are resolved using a dice-roll system, with Evolved Units providing combat bonuses. Detailed battle reports are generated.

**AI Interaction:**
*   AIs receive the current game state (including `mapNodes` with `standardUnits`, `evolvedUnits`, `isHubActive`, `hasFabricationHub`, `mapType`, `hubDisconnectedTurn`) as JSON.
*   They output their decisions for the current phase in a structured JSON format: `{ "actions": [...], "tacticalAnalysis": "string" }`.
    *   **MANEUVER Actions:** `DEPLOY_UNITS`, `MOVE_UNITS`, `ACTIVATE_FABRICATION_HUB`, `EVOLVE_UNITS`.
    *   **COMBAT Actions:** `ATTACK_NODE`.
*   The AI system prompts include detailed rules and checklists for action validity, emphasizing sequential planning (e.g., deploy before moving new units, activate hub before evolving).
*   System Log entries are generated for significant AI actions, game events, and errors.

**Winning:**
A faction wins if:
1.  **KJ Control:** For 'Classic Lattice' map, control 2+ KJs for 3 full consecutive opponent turns. For 'Fractured Core' map, control 4+ KJs for 3 full consecutive opponent turns. For other maps (e.g., Global Conflict, Twin Peaks), control 2+ KJs for 2 full consecutive opponent turns. KJs MUST be connected to a friendly CN.
2.  **Annihilation:** They eliminate all of the opponent's Command Nodes (CNs) AND all of their units.
3.  **Score Victory:** The game reaches the maximum turn limit (e.g., 20 turns), and they have the highest score (calculated based on QR, controlled nodes, KJs, and total units).
4.  A DRAW can occur if both factions are mutually annihilated or if scores are tied at max turns.

This mode is designed to test the AIs' strategic planning, resource management, and adaptive decision-making capabilities in a dynamic conflict scenario. The introduction of Fabrication Hubs and Evolved Units aims to deepen the strategic complexity. The connectivity requirement for resources, Hubs, and KJ victory adds another critical layer to territorial control.
